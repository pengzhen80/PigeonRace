<!DOCTYPE html>
<html>
{% load static %}

<head>
    <!-- <meta charset="utf-8"> -->
    <title>活動頁面</title>
    <!-- for map -->
    <script src="https://maps.googleapis.com/maps/api/js?key=" async defer></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.gridlayer.googlemutant@latest/dist/Leaflet.GoogleMutant.js"></script>
    <!-- for header -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <!-- <link rel="stylesheet" href="{% static 'css/table.css' %}" /> -->
    <!-- css for header -->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/fontawesome.css' %}">
    <link rel="stylesheet" href="{% static 'css/templatemo-space-dynamic.css' %}">
    <style>
        .myDiv_table {
            /* border: 1px outset black; */
            /* background-color: lightblue;     */
            text-align: center;
            width:100%;
            height: 400px;
            top : 100px;
            position: relative;
        }
    .label_plots {
        display: block;
        /* width: 130px; */
        width : 100%;
        height: 48px;
        background-color : rgba(106,90,205,0.5);
        text-align: "left";
        font-size : 36px;
        cursor : help;
    }
    .myDiv_map {
        border: 1px outset black;
        background-color: lightblue;    
        text-align: center;
        width:100%;
        height: 400px;
    }
    .myDiv_plots {
        border: 1px outset black;
        background-color: transparent;    
        text-align: center;
        width:100%;
        height: 500px;
    }
    .myDiv_chart {
        width:100%;
        height: 40%;
    }
    </style>
</head>
<header class="header-area header-sticky wow slideInDown animated background-header" data-wow-duration="0.75s" data-wow-delay="0s" style="visibility: visible;-webkit-animation-duration: 0.75s; -moz-animation-duration: 0.75s; animation-duration: 0.75s;-webkit-animation-delay: 0s; -moz-animation-delay: 0s; animation-delay: 0s;">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <nav class="main-nav">
            <!-- ***** Logo Start ***** -->
            <a href="../login" class="logo">
              <h4>Sky<span>Leader</span></h4>
            </a>
            <!-- ***** Logo End ***** -->
            <!-- ***** Menu Start ***** -->
            <ul class="nav">
              <li class="scroll-to-section"><a href="../../login"  class="active">Home</a></li>
              <li class="scroll-to-section"><a href="../activity" class="">Activity</a></li>
              <li class="scroll-to-section"><a href="#pigeon" class="">Pigeon</a></li>
            </ul>        
            <!-- <a class="menu-trigger">
                <span>Menu</span>
            </a> -->
            <!-- ***** Menu End ***** -->
          </nav>
        </div>
      </div>
    </div>
</header>
<body>
    <div class="container">
    <div id = 'div_trainRecord_table' class = 'myDiv_table'>
    <table id="table_trainRecord" class="table table-striped table-bordered table-hover"><h4>平均直線分速排名</h4>
        <!-- <caption><h4>平均直線分速排名</h4></caption>     -->
        <thead class="thead-dark">
                <tr>
                    <!-- <th></th> -->
                    <!-- <th>公環號碼</th> -->
                    <!-- <th>放飛時間</th> -->
                    <th>實際飛行距離(m)</th>
                    <th>實際飛行速度(m/min)</th>
                    <th>直線距離(m)</th>
                    <th>直線分速(m/min)</th>
                    <th>路徑效率</th>
                </tr>
            </thead>
            <tbody id="table_trainRecord_body">
            </tbody>
    </table>
    </div>
    <br></br>
    <!-- <br></br>
    <br></br> -->
    <div id ='routeEff_Polyline_plot' class = 'myDiv_plots' >
        <label id="label_routeEff_Polyline_plot" class="label_plots">路徑效率折線圖</label>
        <br></br>
        <div id="canvas_routeEff_Polyline_plot" class="myDiv_chart"></div>
      </div>
      <div id ='multiRoutes_routeSimilarity' class = 'myDiv_plots' >
        <label id="label_multiRoutes_routeSimilarity" class="label_plots">路徑相似度</label>
        <br></br>
        <div id="canvas_multiRoutes_routeSimilarity" class="myDiv_chart"></div>
      </div>
    </div>
    <script>
        let pigeonNumber = '{{ pigeonNumber|safe }}';
        let localFilteredRecords = '{{ localFilteredRecords|safe }}';
        let normalized_localFilteredRecords = JSON.parse(localFilteredRecords)
        console.log(normalized_localFilteredRecords);

        rankStraightSpeed_showInTable(normalized_localFilteredRecords);
        function rankStraightSpeed_showInTable(dataList) {
            let table_trainRecord_body = document.getElementById('table_trainRecord_body');
            for (var i = 0; i < dataList.length; i++) {
                func_table_activity_addData(dataList[i][4], dataList[i][5],dataList[i][6],dataList[i][7],dataList[i][8]);
            }
            function func_table_activity_addData(realDistance, realSpeed,straightDistance,straightSpeed,routeEfficiency) {
                var row = document.createElement('tr');
                // var row_data_0 = document.createElement("INPUT");
                // row_data_0.setAttribute("type", "checkbox");
                // row_data_0.style.position = 'absolute';
                // row_data_0.style.top = '30%';
                // var row_data_1 = document.createElement('td');
                // row_data_1.innerHTML = pigeonNumber;
                // row_data_1.style.textAlign = "center";
                var row_data_2 = document.createElement('td');
                row_data_2.innerHTML = realDistance.toFixed(3);
                // row_data_2.style.textAlign = "center";
                var row_data_3 = document.createElement('td');
                row_data_3.innerHTML = realSpeed.toFixed(3);
                // row_data_3.style.textAlign = "center";
                var row_data_4 = document.createElement('td');
                row_data_4.innerHTML = straightDistance.toFixed(3);
                var row_data_5 = document.createElement('td');
                row_data_5.innerHTML = straightSpeed.toFixed(3);
                var row_data_6 = document.createElement('td');
                row_data_6.innerHTML = routeEfficiency.toFixed(3);


                // row.appendChild(row_data_0);
                // row.appendChild(row_data_1);
                row.appendChild(row_data_2);
                row.appendChild(row_data_3);
                row.appendChild(row_data_4);
                row.appendChild(row_data_5);
                row.appendChild(row_data_6);

                // function func_cb_row()
                // {
                //     console.log('click');
                //     var pigeonNumber = row_data_1.innerHTML;
                //     console.log(pigeonNumber); 
                //     window.open('login/pigeon/'+pigeonNumber);
                // }
                // row.addEventListener('click',func_cb_row);
                table_trainRecord_body.appendChild(row);
            }
        }
    </script>
</body>